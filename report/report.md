# 地球物理数値解析　レポート課題（天野担当分）

- 以下の課題A，B，Cから2題以上を選択し，レポートにまとめて提出せよ．
- 提出期限は2023年5月28日（日）の23:59 JST（日本標準時）とする．
- 提出はITC-LMSにPDFファイルをアップロードすること．
- 質問・相談は随時受け付ける．
- 課題A（感想）以外についてはChatGPTなどのツールの使用は許可する．ただし，どのように使用したか明記すること．特に有用と思われる場合にはChatGPTとのやり取りを <https://sharegpt.com/> などを使って分かるように提出することを推奨する．

---

# 課題A
天野担当分の講義や資料に関する感想を述べよ．（感想の内容については評価しないので正直に．）

# 課題B
1. 講義スライドに記載されている問題のうち以下について解答をまとめよ．
Q.3-6, Q.3-8, Q.3-14, Q.4-1, Q.4-2, Q.4-6, Q.4-7

2. 1次元Euler方程式を基本変数$(\rho, v, p)$を使って非保存系で書き下すと
$$
\frac{\partial}{\partial t}
\begin{pmatrix} \rho \\ v \\ p \end{pmatrix} +
\bm{A} \cdot
\frac{\partial}{\partial x}
\begin{pmatrix} \rho \\ v \\ p \end{pmatrix} = 0,
\quad \quad
\bm{A} =
\begin{pmatrix}
v & \rho & 0 \\
0 & v & 1/\rho \\
0 & -\gamma p & v
\end{pmatrix}
$$
と書ける．この行列$\bm{A}$を対角化して，固有値と固有ベクトルを求めよ．

3. Euler方程式（またはより一般の他変数の非線形双曲型偏微分方程式）の数値解法を設計するにあたって，線形移流方程式の数値解法の考え方がどのように生かされるか議論せよ．

# 課題C
1. 線形移流方程式の数値解を1次精度風上差分法およびLax-Wendroff法を用いて求め，誤差$\epsilon$がそれぞれ$\epsilon \propto \Delta x^1$および$\epsilon \propto \Delta x^2$となることを示せ．なお，計算領域は$0 \leq x \leq 1$，境界条件は周期境界条件，初期条件は
$$
u(x) = \sin \left ( 2 \pi x \right)
$$
とする．ただし，$t = 1$における数値解と解析解の差から
$$
\epsilon =
\sqrt{ \int \vert u(x) - u_{\rm analytic}(x) \rvert^2 dx} =
\sqrt{ \sum_{i} \lvert u_{i}^{n} - u_{\rm analytic}(x_i) \rvert^2 \Delta x}
$$
を誤差と定義しよう．もちろん$\Delta x$を小さくとるには$\Delta t$も小さくしなければならないので，$t = 1$まで計算するのに必要なステップ数が増えることに注意せよ．少なくとも1桁以上は$\Delta x$を変化させて，$\epsilon$と$\Delta x$の関係を両対数でプロットすること．

1. 以下の設定のもとで非粘性Burgers方程式の数値解を1次精度風上差分法および2段階Lax-Wendroff法（人工粘性あり）を用いて求め，両者を比較・考察せよ．
計算領域は$-1 \leq x \leq +1$，境界条件は周期境界条件，初期条件は
$$
u(x) =
\begin{cases}
& 0 \quad -1 < x < -\frac{1}{3} \\
& 1 \quad -\frac{1}{3} < x < +\frac{1}{3} \\
& 0 \quad +\frac{1}{3} < x < 1 \\
\end{cases}
$$
とする．

1. 1次元Euler方程式について，周期境界条件のもとで正方向，および負方向に伝播する音波の固有モードをそれぞれ初期条件に選んだときの時間発展を2段階Lax-Wendroff法によって数値的に求めよ．それぞれの場合について振幅依存性を考察すること．ただし，初期条件でエントロピー一定を仮定し，ある固有モードを考えているときには，もう一方のモードの振幅は0になるように初期条件を選ぶこと.

1. 1次元Euler方程式について，Sodの衝撃波管問題を考えよう．初期条件は
$$
(\rho, v, p)
=
\begin{cases}
(1, 0, 1) \quad & x < 0
\\
(0.125, 0, 0.1) \quad & x > 0
\end{cases}
$$
で，$\gamma = 1.4$とし，境界条件としては対称境界($\partial/\partial x = 0$)を採用せよ．  
任意の計算スキームで$t \simeq 0.5$程度まで計算した数値解からそのスキーム性質を考察すること．例えば，2段階Lax-Wendroff法を用いる場合には，(i) Courant数を固定して$\Delta x$を変える，(ii) Courant数を変える, (iii) 人工粘性係数や人工粘性の表式を変える，などして結果を考察するとよい．この問題に適した人工粘性の与え方が他の初期条件（例えば衝撃波がより強い場合，弱い場合）でも有効かどうか試してみるのも面白い．
